<!DOCTYPE html>
<!--
  ~ Copyright (c) 2017 RockScript.io.
  ~ Licensed to the Apache Software Foundation (ASF) under one
  ~ or more contributor license agreements.  See the NOTICE file
  ~ distributed with this work for additional information
  ~ regarding copyright ownership.  The ASF licenses this file
  ~ to you under the Apache License, Version 2.0 (the
  ~ "License"); you may not use this file except in compliance
  ~ with the License.  You may obtain a copy of the License at
  ~
  ~   http://www.apache.org/licenses/LICENSE-2.0
  ~
  ~ Unless required by applicable law or agreed to in writing,
  ~ software distributed under the License is distributed on an
  ~ "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  ~ KIND, either express or implied.  See the License for the
  ~ specific language governing permissions and limitations
  ~ under the License.
  -->
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>RockScript API</title>
  <style>
    @font-face {
      font-family: 'Roboto Slab';
      font-style: normal;
      font-weight: 300;
      src: local('Roboto Slab'), local('RobotoSlab'), url(fonts/roboto-slab-300.woff2) format('woff2');
      unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215;
    }
    @font-face {
      font-family: 'Open Sans';
      font-style: normal;
      font-weight: 400;
      src: local('Open Sans Regular'), local('OpenSans-Regular'), url(fonts/open-sans-400.woff2) format('woff2');
      unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215;
    }
    @font-face {
      font-family: 'Open Sans';
      font-style: normal;
      font-weight: 700;
      src: local('Open Sans Bold'), local('OpenSans-Bold'), url(fonts/open-sans-700.woff2) format('woff2');
      unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215;
    }
  </style>

  <script src="js/jquery-3.2.1.min.js"></script>
  <script src="js/showdown-1.8.2.min.js"></script>

  <script type="application/javascript">
    var converter = new showdown.Converter();

    window.addEventListener('load', function() {
      show('introduction');
      $.get('http://localhost:3652/docs', function(data) {
        docs = JSON.parse(data);
        let tocHtml =
            '<div class="title">Commands</div>' +
            docs.commands.map(function(command) {
              return '<a class="link" onclick="show(\''+command.id+'\')">'+command.label+'</a>';
            }).join();
        $('#commands').html(tocHtml);

        var contentHtml = docs.commands.map(function(command) {
          return '<div id="'+command.id+'" class="hidden">' +
              '  '+converter.makeHtml(command.content)+
              '</div>';
        }).join();
        $('.content').append(contentHtml);
      });
    });

    function show(id) {
      $('.content').children().addClass("hidden");
      $('#'+id).removeClass("hidden");
    }
  </script>
  <style>
    body {
      font-family: "Open Sans";
      letter-spacing: -.3px;
      margin: 0;
      height: 100%;
    }

    a:not([href]) {
      cursor: pointer;
    }

    a, a:visited {
      text-decoration: none;
      font-weight: bold;
      color: #1a90bf;
    }

    a:hover {
      text-decoration: underline;
    }

    code {
      font-weight: bold;
      color: #444;
    }

    .titlebar {
      background-color: #2B7191 !important;
      color: white;
      padding: 15px;
    }

    .titlebar > .brand {
      font-family: "Roboto Slab";
      display: inline-block;
      opacity: .7;
      margin-right: 30px;
    }

    .titlebar > .title {
      font-size: 1.3em;
      display: inline-block;
    }

    .toc {
      width: 100%;
      padding: 15px 0 0 15px;
      border: solid 0 #ddd;
      float: left;
      border-width: 0 0 1px 0;
    }

    @media (min-width: 800px) {
      .toc {
        width: 200px;
        border-width: 0 1px 0 0;
        height: calc(100vh - 73px);
      }
    }

    .section {
      margin-bottom: 10px;
    }

    .section > .title {
      font-size: 1.1em;
      margin-bottom: 4px;
    }

    .section > .link {
      display: block;
      padding-left: 10px;
    }

    a.link:hover {
      color: #275c7a;
    }

    .content {
      padding: 15px;
      width: calc(100% - 30px);
      float: right;
    }

    @media (min-width: 800px) {
      .content {
        width: calc(100% - 247px);
      }
    }

    .content h1 {
      font-size: 1.5em;
      margin-top: 0;
    }

    .content pre code {
      background-color: #fffcf8;
      border: 1px solid #ddd;
      padding: 7px 10px 7px 10px;
      display: block;
    }

    .hidden {
      display: none;
    }
  </style>
</head>
<body>

<a onclick="show('introduction')">
<div class="titlebar">
  <div class="brand"><img alt="RockScript.io" src="img/hand-white.png" height="16">RockScript.io</div>
  <div class="title">RockScript API documentation</div>
</div>
</a>

<div class="toc">
  <div class="section">
    <div class="title">General</div>
    <a class="link" onclick="show('introduction')">Introduction</a>
    <a class="link" onclick="show('authentication')">Authentication</a>
    <a class="link" onclick="show('help')">Help</a>
  </div>
  <div id="commands" class="section">
  </div>
  <div class="section">
    <div class="title">Queries</div>
    <a class="link">Introduction</a>
  </div>
</div>
<div class="content">

  <div id="introduction">
    <h1 id="rockscriptapidocumentation">RockScript API documentation</h1>
    <p>The RockScript API is a HTTP API that consists of </p>
    <ul>
      <li>Commands</li>
      <li>Queries</li>
    </ul>
    <h3 id="commands">Commands</h3>
    <p>Commands are RPC style operations that change the state of the RockScript server.
      Commands are invoked by a HTTP POST to <code>http://localhost:3652/command</code> with the command
      JSON as the body.  We hope to add message based API later.
      Commands have a the following JSON serialization form
      (aka <a href="https://fasterxml.github.io/jackson-annotations/javadoc/2.9/com/fasterxml/jackson/annotation/JsonTypeInfo.As.html#WRAPPER_OBJECT">wrapper object</a>):</p>
    <pre><code>{"commandName": { ...command data fields... }}</code></pre>
    <p>Example of a command request/response:</p>
    <pre><code>&gt; POST http://localhost:3652/command
&gt; { "saveScript": {
&gt;     "scriptName": "My first script",
&gt;     "scriptText": "var v = 42;"
&gt; }}

&lt; HTTP/1.1 200 OK
&lt; Access-Control-Allow-Origin: *
&lt; { "id":"sv1",
&lt;   "scriptId":"s1",
&lt;   "name":"My first script",
&lt;   "version":1,
&lt;   "text":"var v = 42;"}</code></pre>
    <h3 id="queries">Queries</h3>
    <p>Queries fetch data without changing the state of the server.</p>
  </div>

  <div id="authentication" class="hidden">
    <h1>Authentication</h1>
    <p>At this time RockScript does not yet support any form of authentication.</p>
  </div>

  <div id="help" class="hidden">
    <h1>Help</h1>
    <p>If this documention is insufficient, please contact us on <a href="https://github.com/rockscript/rockscript/issues">our forum.</a></p>
  </div>

</div>

</body>
</html>